\ BankOcr

3  CONSTANT OCR-WIDTH
3  CONSTANT OCR-HEIGHT

VARIABLE ACCOUNT-SIZE 
9  ACCOUNT-SIZE !

: OCR-LINE-SIZE ACCOUNT-SIZE @ OCR-WIDTH * ;

CREATE OCR-BUFFER 
OCR-LINE-SIZE OCR-HEIGHT * ALLOT

: BAR? 32 <> 1 AND ;

: OCR-OFFSET ( i -- pos of char i in ocr digit )
    ?DUP 0= IF 1 ELSE
    1- OCR-HEIGHT /MOD 
    1+ OCR-LINE-SIZE * 
    SWAP + 
    THEN ;
       
: OCR-ADDRESS ( n i -- addr  char i or nth ocr digit ) 
    OCR-OFFSET SWAP OCR-WIDTH * 
    + OCR-BUFFER + ;

: EMPTY-OCR-BUFFER ( -- )
    OCR-BUFFER OCR-LINE-SIZE OCR-HEIGHT * 20 FILL ;

: OCR>PATTERN ( n -- b )
    DUP 0 OCR-ADDRESS C@ BAR? ( n b )
    7 1 DO 1 LSHIFT OVER I OCR-ADDRESS C@ BAR?  OR LOOP
    NIP ;
    
